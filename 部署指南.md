# ğŸš€ AIè¯¾å ‚åŠ©æ‰‹éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£æä¾›äº†å¤šç§éƒ¨ç½²æ–¹æ¡ˆï¼Œè®©ä½ çš„AIè¯¾å ‚åŠ©æ‰‹å¯ä»¥åœ¨çº¿ä¸Šä¸ºæ›´å¤šäººæä¾›æœåŠ¡ã€‚

## ğŸ“‹ éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | éš¾åº¦ | æˆæœ¬ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|------|----------|
| äº‘æœåŠ¡å™¨ + Docker | â­â­ | ä½ | å®Œå…¨æ§åˆ¶ï¼Œé«˜æ€§èƒ½ | æ­£å¼ç”Ÿäº§ç¯å¢ƒ |
| Vercel + Railway | â­ | å…è´¹/ä½ | è‡ªåŠ¨éƒ¨ç½²ï¼Œæ— éœ€è¿ç»´ | ä¸ªäººé¡¹ç›®ï¼Œå¿«é€Ÿä¸Šçº¿ |
| æœ¬åœ°ç©¿é€ | â­ | å…è´¹ | å¿«é€Ÿæµ‹è¯• | ä¸´æ—¶åˆ†äº«ï¼Œå¼€å‘æµ‹è¯• |

## ğŸ† æ¨èæ–¹æ¡ˆï¼šäº‘æœåŠ¡å™¨ + Docker

### å‡†å¤‡å·¥ä½œ

1. **è´­ä¹°äº‘æœåŠ¡å™¨**
   - é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ç­‰
   - æ¨èé…ç½®ï¼š2æ ¸4Gå†…å­˜ï¼Œ40Gç¡¬ç›˜
   - æ“ä½œç³»ç»Ÿï¼šUbuntu 20.04 æˆ– CentOS 8

2. **åŸŸåå‡†å¤‡** (å¯é€‰ä½†æ¨è)
   - è´­ä¹°åŸŸåå¹¶è§£æåˆ°æœåŠ¡å™¨IP
   - ä¾‹å¦‚ï¼š`classroom.yourdomain.com`

3. **è·å–APIå¯†é’¥**
   - è®¿é—® [Google AI Studio](https://aistudio.google.com/app/apikey)
   - åˆ›å»ºå¹¶å¤åˆ¶APIå¯†é’¥

### ğŸš€ ä¸€é”®éƒ¨ç½²

#### æ–¹æ³•1ï¼šå®Œæ•´ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

   ```bash
# ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/io-oi-ai/Classroom-learning-assistant/main/deploy_production.sh

# ç»™æ‰§è¡Œæƒé™
chmod +x deploy_production.sh

# ä»¥rootç”¨æˆ·æ‰§è¡Œ
sudo ./deploy_production.sh
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- âœ… è‡ªåŠ¨å®‰è£…æ‰€æœ‰ä¾èµ–
- âœ… é…ç½®HTTPSè¯ä¹¦
- âœ… è®¾ç½®é˜²ç«å¢™å’Œå®‰å…¨
- âœ… é…ç½®Nginxåå‘ä»£ç†
- âœ… è‡ªåŠ¨ç›‘æ§å’Œé‡å¯
- âœ… å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ

#### æ–¹æ³•2ï¼šå¿«é€Ÿæµ‹è¯•éƒ¨ç½²

   ```bash
# ä¸‹è½½å¿«é€Ÿéƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/io-oi-ai/Classroom-learning-assistant/main/quick_deploy.sh

# ç»™æ‰§è¡Œæƒé™
chmod +x quick_deploy.sh

# æ‰§è¡Œéƒ¨ç½²
sudo ./quick_deploy.sh
```

**é€‚ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿæµ‹è¯•åŠŸèƒ½
- å†…ç½‘ç¯å¢ƒä½¿ç”¨
- å¼€å‘ç¯å¢ƒæ­å»º

### ğŸ“± æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

å¦‚æœè‡ªåŠ¨è„šæœ¬é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨éƒ¨ç½²ï¼š

#### 1. å®‰è£…Docker

   ```bash
# Ubuntu/Debian
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo systemctl start docker
sudo systemctl enable docker

# CentOS/RHEL
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo yum install -y docker-ce docker-ce-cli containerd.io
sudo systemctl start docker
sudo systemctl enable docker
```

#### 2. å®‰è£…Docker Compose

   ```bash
sudo curl -L "https://github.com/docker/compose/releases/download/v2.21.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
   ```

#### 3. å…‹éš†é¡¹ç›®

   ```bash
git clone https://github.com/io-oi-ai/Classroom-learning-assistant.git
cd Classroom-learning-assistant
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

```bash
# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env << EOF
GOOGLE_AI_API_KEY=your_api_key_here
PORT=8001
HOST=0.0.0.0
DEBUG=false
NEXT_PUBLIC_API_URL=http://your_server_ip:3000
EOF
```

#### 5. å¯åŠ¨æœåŠ¡

   ```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
sudo docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
sudo docker-compose logs -f
```

#### 6. é…ç½®é˜²ç«å¢™

   ```bash
# Ubuntu (ufw)
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 3000/tcp
sudo ufw allow 8001/tcp
sudo ufw enable

# CentOS (firewalld)
sudo firewall-cmd --permanent --add-port=22/tcp
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --permanent --add-port=3000/tcp
sudo firewall-cmd --permanent --add-port=8001/tcp
sudo firewall-cmd --reload
```

## ğŸŒ æ–¹æ¡ˆ2ï¼šå…è´¹éƒ¨ç½² (Vercel + Railway)

### å‰ç«¯éƒ¨ç½²åˆ°Vercel

1. **Forké¡¹ç›®åˆ°ä½ çš„GitHub**
2. **ç™»å½•Vercel**
   - è®¿é—® [vercel.com](https://vercel.com)
   - ä½¿ç”¨GitHubç™»å½•
3. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡»"New Project"
   - é€‰æ‹©ä½ forkçš„ä»“åº“
4. **é…ç½®ç¯å¢ƒå˜é‡**
   ```
   NEXT_PUBLIC_API_URL=https://your-backend-url
   ```
5. **éƒ¨ç½²**
   - ç‚¹å‡»Deployï¼Œç­‰å¾…éƒ¨ç½²å®Œæˆ

### åç«¯éƒ¨ç½²åˆ°Railway

1. **ç™»å½•Railway**
   - è®¿é—® [railway.app](https://railway.app)
   - ä½¿ç”¨GitHubç™»å½•
2. **åˆ›å»ºæ–°é¡¹ç›®**
   - é€‰æ‹©"Deploy from GitHub repo"
   - é€‰æ‹©backendç›®å½•
3. **é…ç½®ç¯å¢ƒå˜é‡**
   ```
   GOOGLE_AI_API_KEY=your_api_key
   PORT=8000
   HOST=0.0.0.0
   ```
4. **éƒ¨ç½²**
   - Railwayä¼šè‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²

## ğŸ“± æ–¹æ¡ˆ3ï¼šå†…ç½‘ç©¿é€ (ä¸´æ—¶åˆ†äº«)

é€‚åˆå¿«é€Ÿåˆ†äº«ç»™æœ‹å‹æµ‹è¯•ä½¿ç”¨ï¼š

### ä½¿ç”¨ngrok

   ```bash
# å®‰è£…ngrok
wget https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip
unzip ngrok-stable-linux-amd64.zip

# å¯åŠ¨æœ¬åœ°æœåŠ¡
npm run dev &
cd backend && python3 working_server.py &

# åˆ›å»ºéš§é“
./ngrok http 3000
```

### ä½¿ç”¨frp

   ```bash
# ä¸‹è½½frpå®¢æˆ·ç«¯
wget https://github.com/fatedier/frp/releases/download/v0.51.3/frp_0.51.3_linux_amd64.tar.gz
tar -xzf frp_0.51.3_linux_amd64.tar.gz

# é…ç½®å®¢æˆ·ç«¯
cat > frpc.ini << EOF
[common]
server_addr = your_server_ip
server_port = 7000

[web]
type = http
local_port = 3000
custom_domains = your_domain.com
   EOF
   
# å¯åŠ¨å®¢æˆ·ç«¯
./frpc -c frpc.ini
```

## ğŸ”§ ç®¡ç†å’Œç»´æŠ¤

### å¸¸ç”¨å‘½ä»¤

   ```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# æ›´æ–°ä»£ç 
git pull origin main
docker-compose up -d --build

# å¤‡ä»½æ•°æ®
tar -czf backup_$(date +%Y%m%d).tar.gz uploads/ backend/data/

# æ¢å¤æ•°æ®
tar -xzf backup_20240101.tar.gz
```

### æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨Redisç¼“å­˜**
   ```bash
   docker-compose --profile production up -d
   ```

2. **é…ç½®CDN**
   - å°†uploadsç›®å½•ä¸Šä¼ åˆ°OSS/COS
   - é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº

3. **æ•°æ®åº“ä¼˜åŒ–**
   - å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶
   - ç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µ

### å®‰å…¨å»ºè®®

1. **å®šæœŸæ›´æ–°**
   ```bash
   # æ›´æ–°ç³»ç»Ÿ
   sudo apt update && sudo apt upgrade -y
   
   # æ›´æ–°Dockeré•œåƒ
   docker-compose pull
   docker-compose up -d
   ```

2. **å¤‡ä»½ç­–ç•¥**
   ```bash
   # åˆ›å»ºå®šæ—¶å¤‡ä»½
   echo "0 2 * * * cd /root/ai-classroom && tar -czf /backups/backup_\$(date +\%Y\%m\%d).tar.gz uploads/ backend/data/" | crontab -
   ```

3. **ç›‘æ§å‘Šè­¦**
   ```bash
   # å®‰è£…ç›‘æ§å·¥å…·
   sudo apt install htop iotop nethogs
   
   # è®¾ç½®ç£ç›˜ç©ºé—´ç›‘æ§
   echo "*/10 * * * * df -h | awk '\$5 > 85 {print \$0}' | mail -s 'Disk Space Warning' your-email@example.com" | crontab -
   ```

## ğŸ¯ éƒ¨ç½²åéªŒè¯

### åŠŸèƒ½æµ‹è¯•æ¸…å•

- [ ] å‰ç«¯é¡µé¢æ­£å¸¸è®¿é—®
- [ ] ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [ ] AIèŠå¤©å¯¹è¯
- [ ] ç¬”è®°å¡ç‰‡ç”Ÿæˆ
- [ ] è¯¾ç¨‹ç®¡ç†åŠŸèƒ½
- [ ] å“åº”é€Ÿåº¦æµ‹è¯•
- [ ] ç§»åŠ¨ç«¯é€‚é…

### æ€§èƒ½åŸºå‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| é¡µé¢åŠ è½½æ—¶é—´ | < 3ç§’ |
| APIå“åº”æ—¶é—´ | < 2ç§’ |
| æ–‡ä»¶ä¸Šä¼ é€Ÿåº¦ | > 1MB/s |
| å¹¶å‘ç”¨æˆ·æ•° | > 100 |

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: Dockerå¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥DockerçŠ¶æ€
sudo systemctl status docker

# é‡å¯Docker
sudo systemctl restart docker

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u docker.service
```

### Q2: ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep :3000

# æ€æ­»è¿›ç¨‹
sudo kill -9 <PID>
```

### Q3: SSLè¯ä¹¦ç”³è¯·å¤±è´¥
```bash
# æ£€æŸ¥åŸŸåè§£æ
nslookup your-domain.com

# æ‰‹åŠ¨ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d your-domain.com
```

### Q4: å†…å­˜ä¸è¶³
```bash
# å¢åŠ äº¤æ¢ç©ºé—´
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°éƒ¨ç½²é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š

1. **GitHub Issues**: [æäº¤é—®é¢˜](https://github.com/io-oi-ai/Classroom-learning-assistant/issues)
2. **æ–‡æ¡£æ›´æ–°**: å®šæœŸæŸ¥çœ‹éƒ¨ç½²æ–‡æ¡£æ›´æ–°
3. **ç¤¾åŒºè®¨è®º**: å‚ä¸é¡¹ç›®è®¨è®ºå’Œç»éªŒåˆ†äº«

---

ğŸ‰ **æ­å–œï¼ä½ çš„AIè¯¾å ‚åŠ©æ‰‹ç°åœ¨å¯ä»¥ä¸ºæ›´å¤šäººæä¾›æœåŠ¡äº†ï¼**

è®°å¾—å®šæœŸå¤‡ä»½æ•°æ®å’Œæ›´æ–°ç³»ç»Ÿï¼Œç¡®ä¿æœåŠ¡çš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§ã€‚ 